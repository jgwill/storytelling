# Prompt Decomposition â€” Relational & Visionary Facet

## Directions

- ğŸŒ… **EAST** â€” VISION: What is being asked?
- ğŸ”¥ **SOUTH** â€” ANALYSIS: What needs to be learned?
- ğŸŒŠ **WEST** â€” VALIDATION: What needs reflection?
- â„ï¸ **NORTH** â€” ACTION: What executes the cycle?

## Original Prompt

> WillWrite README has architecture overview. Our rispecs were written from WillWrite. Now our README should have a better architecture section with diagrams â€” using llms-stc-state-machine.md to represent states changed within the pipeline. Add a separate section for "Envisioned Next Major Architecture" with codename from Narintel Suite / medicine-wheel directions. mcp-pde decompose and start working.

## Primary Intent

**Action:** advance
**Target:** README.md as a living architectural document that bridges current reality (Python LangGraph pipeline) with desired state (WÃ¢pano NARINTEL:EAST â€” full Four Directions narrative intelligence)
**Urgency:** session
**Confidence:** 94%

## Secondary Intents

1. **contextualize** â€” The WillWrite repo (jgwill/WillWrite) is the ancestor; our specs came from there; now we GIVE BACK by having a richer, more grounded architecture section than WillWrite has _(implicit)_
2. **honor** â€” The STC state machine framing: the pipeline IS a structural tension resolver (prompt as current reality â†’ complete story as desired state) _(explicit)_
3. **manifest** â€” Codename "WÃ¢pano" (East direction, Cree language) as the next major NARINTEL release identity _(explicit)_
4. **reveal** â€” The oscillation risk in the current pipeline (chapter revision loop = oscillation if not guarded) â€” visible in the state machine diagram _(implicit from llms-stc-state-machine.md)_
5. **distinguish** â€” What IS implemented (graph.py + NARINTEL modules) vs. what IS ENVISIONED (full Four Directions multi-agent, smcraft state machine, JS parity) _(explicit)_
6. **bridge** â€” The WillWrite lineage: we are the Python RISE-aligned evolution of jgwill/WillWrite, not a fork â€” a kinship successor _(implicit)_

## Relational Context

### Lineage
- **Parent**: `jgwill/WillWrite` (AI Story Generator) â€” the JavaScript ancestor whose architecture we studied and whose documentation patterns we echo
- **Sibling**: `jgwill/medicine-wheel` â€” provides the Four Directions ontology, narrative-engine, ceremony-protocol packages
- **Integration Target**: `/a/src/IAIP/` â€” ceremonial-technology consumer of the storytelling package
- **Companion**: `avadisabelle/ava-langchain` / `ava-langgraph` â€” the orchestration runtime

### Structural Tension (STC framing of this task)
- **Current Reality**: README.md has no architecture diagrams; the pipeline structure is hidden from new contributors
- **Desired Outcome**: README.md reveals the full pipeline visually, maps it to STC state machine semantics, and marks the creative horizon (WÃ¢pano) with a clear architectural vision
- **Structural Tension**: The gap between what the code does and what the README communicates
- **Energy**: Every new contributor who reads the README and immediately understands the system

## Four Directions Analysis

### ğŸŒ… EAST â€” VISION

- The diagram should feel like a MAP: someone reading it immediately knows WHERE they are in the story generation journey [96%]
- The WÃ¢pano section should feel like HORIZON: readers can see where the system is growing, not just where it is [92%]
- The WillWrite BlockDiagram.drawio.svg was flat; ours should be multi-layered (pipeline layer, state layer, vision layer) [88%] _(implicit)_

### ğŸ”¥ SOUTH â€” ANALYSIS

- **Current pipeline nodes** (from graph.py lines 1197-1213):
  1. `extract_base_context` â€” captures meta-instructions from prompt
  2. `generate_story_elements` â€” extracts characters, themes, plot elements
  3. `generate_initial_outline` â€” creates full story outline
  4. `determine_chapter_count` â€” decides number of chapters
  5. `generate_single_chapter_scene_by_scene` â€” generates chapter content (4 scenes)
  6. `revise_buzz_terms` â€” removes overused AI phrases
  7. `critique_chapter` â€” evaluates chapter quality
  8. `check_chapter_complete` â€” decides: revise or advance?
  9. `revise_chapter` â€” refines chapter based on critique
  10. `increment_chapter_index` â€” advances to next chapter
  11. `generate_final_story` â€” assembles final narrative
- **Conditional edges** (oscillation risk points):
  - `check_chapter_complete`: should_revise_chapter â†’ {revise | increment}
  - `increment_chapter_index`: check_if_more_chapters_needed â†’ {generate_chapter | finalize}
- **STC phase mapping**:
  - **Germination** (tension_established): extract_base_context â†’ generate_story_elements â†’ generate_initial_outline â†’ determine_chapter_count
  - **Assimilation** (action_step_completed loops): generate_chapter â†’ revise_buzz_terms â†’ critique â†’ [revise loop OR advance] for each chapter
  - **Completion** (tension_resolve): generate_final_story â†’ END
- **NARINTEL modules in Python** (partially implemented, not wired into main graph.py):
  - `narrative_story_graph.py` â€” NarrativeAwareStoryGraph (NCP enrichment loop)
  - `narrative_intelligence_integration.py` â€” NCPAwareStoryGenerator
  - `emotional_beat_enricher.py` â€” emotional quality scoring + enrichment
  - `analytical_feedback_loop.py` â€” gap identification + routing
  - `character_arc_tracker.py` â€” persistent character state
  - `ceremonial_diary.py` â€” ceremonial mode
  - `role_tooling.py` â€” Seven-role tooling registry

### ğŸŒŠ WEST â€” VALIDATION

- The STC mapping must not be superficial: chapter revision loop genuinely IS an oscillation risk [95%]
- The "WÃ¢pano" codename must be introduced with its Cree meaning â€” not just a label but a grounding [90%]
- The "Implemented" and "Envisioned" sections must be structurally distinct (different heading levels, clear ğŸš§ markers) [96%]
- The NarrativeAware loop diagram should show that it EXISTS in Python code â€” it's real, not pure vision â€” but it's not the default pathway in graph.py [92%] _(implicit)_

### â„ï¸ NORTH â€” ACTION

- Deliver README.md with three distinct sections:
  1. `## ğŸ—ï¸ Architecture Overview` â€” main LangGraph pipeline Mermaid flowchart + STC state overlay + NarIntel enrichment loop
  2. `## ğŸŒ… WÃ¢pano â€” Envisioned Next Major Architecture (NARINTEL:EAST)` â€” Four Directions multi-agent diagram with NCP, ceremonial mode, smcraft integration, JS parity

## Action Stack

- [ ] Extract exact node sequence from graph.py (create_graph function lines 1192-1259)
- [ ] Map nodes to STC phases (Germination / Assimilation / Completion)
- [ ] Draft main Mermaid flowchart â€” complete pipeline with conditional edges visible
- [ ] Draft STC state machine diagram (stateDiagram-v2) â€” pipeline through creative phases
- [ ] Draft NarIntel enrichment loop diagram â€” Generateâ†’Analyzeâ†’Enrichâ†’Track cycle
- [ ] Draft WÃ¢pano vision section â€” Four Directions multi-agent with NARINTEL modules
- [ ] Write codename introduction paragraph (Cree grounding, medicine wheel East = inquiry/dawn)
- [ ] Edit README.md â€” insert after "Key Features" section
- [ ] Git commit with meaningful message

## Ambiguity Flags

- **"Should 'smcraft' integration appear in the WÃ¢pano vision?"**
  - Resolution: Yes â€” smcraft provides the formal state machine runtime that the narrative pipeline would use in WÃ¢pano. Include as a connector node.
- **"Should JS parity appear in WÃ¢pano section?"**
  - Resolution: Yes, but lightly â€” show it as an ecosystem layer, not as a primary architecture concern. Main focus is the Four Directions Python implementation.
- **"How to handle IAIP integration in diagrams?"**
  - Resolution: Reference IAIP as a downstream consumer in the WÃ¢pano section, not in the current pipeline section.

## Expected Outputs

### Artifacts
- README.md (updated)
- (Implicitly: issues/24/plan.md as the implementation plan for this session)

### Updates
- README.md â€” "## ğŸ—ï¸ Architecture Overview" + "## ğŸŒ… WÃ¢pano â€” Envisioned Architecture"
- issues/24/plan.md â€” session plan

### Communications
- Git commit: "[docs] Add Architecture Overview diagrams to README â€” pipeline, STC state machine, and WÃ¢pano vision"
